(function(V,h){typeof exports=="object"&&typeof module<"u"?h(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],h):(V=typeof globalThis<"u"?globalThis:V||self,h(V.ReactEnahncedImage={},V.React))})(this,function(V,h){"use strict";var ee={exports:{}},Q={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ce;function Te(){if(ce)return Q;ce=1;var y=Symbol.for("react.transitional.element"),g=Symbol.for("react.fragment");function _(j,R,d){var m=null;if(d!==void 0&&(m=""+d),R.key!==void 0&&(m=""+R.key),"key"in R){d={};for(var E in R)E!=="key"&&(d[E]=R[E])}else d=R;return R=d.ref,{$$typeof:y,type:j,key:m,ref:R!==void 0?R:null,props:d}}return Q.Fragment=g,Q.jsx=_,Q.jsxs=_,Q}var K={};/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var le;function Ce(){return le||(le=1,process.env.NODE_ENV!=="production"&&function(){function y(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===oe?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case f:return"Fragment";case l:return"Portal";case T:return"Profiler";case u:return"StrictMode";case r:return"Suspense";case t:return"SuspenseList"}if(typeof e=="object")switch(typeof e.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),e.$$typeof){case b:return(e.displayName||"Context")+".Provider";case w:return(e._context.displayName||"Context")+".Consumer";case v:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case c:return n=e.displayName||null,n!==null?n:y(e.type)||"Memo";case D:n=e._payload,e=e._init;try{return y(e(n))}catch{}}return null}function g(e){return""+e}function _(e){try{g(e);var n=!1}catch{n=!0}if(n){n=console;var o=n.error,i=typeof Symbol=="function"&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return o.call(n,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",i),g(e)}}function j(){}function R(){if(q===0){de=console.log,he=console.info,ve=console.warn,ge=console.error,me=console.group,Ee=console.groupCollapsed,we=console.groupEnd;var e={configurable:!0,enumerable:!0,value:j,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}q++}function d(){if(q--,q===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:G({},e,{value:de}),info:G({},e,{value:he}),warn:G({},e,{value:ve}),error:G({},e,{value:ge}),group:G({},e,{value:me}),groupCollapsed:G({},e,{value:Ee}),groupEnd:G({},e,{value:we})})}0>q&&console.error("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}function m(e){if(ae===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);ae=n&&n[1]||"",be=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ae+e+be}function E(e,n){if(!e||se)return"";var o=ue.get(e);if(o!==void 0)return o;se=!0,o=Error.prepareStackTrace,Error.prepareStackTrace=void 0;var i=null;i=B.H,B.H=null,R();try{var N={DetermineComponentFrameRoot:function(){try{if(n){var J=function(){throw Error()};if(Object.defineProperty(J.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(J,[])}catch(H){var ne=H}Reflect.construct(e,[],J)}else{try{J.call()}catch(H){ne=H}e.call(J.prototype)}}else{try{throw Error()}catch(H){ne=H}(J=e())&&typeof J.catch=="function"&&J.catch(function(){})}}catch(H){if(H&&ne&&typeof H.stack=="string")return[H.stack,ne.stack]}return[null,null]}};N.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(N.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(N.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=N.DetermineComponentFrameRoot(),I=s[0],F=s[1];if(I&&F){var Y=I.split(`
`),Z=F.split(`
`);for(s=C=0;C<Y.length&&!Y[C].includes("DetermineComponentFrameRoot");)C++;for(;s<Z.length&&!Z[s].includes("DetermineComponentFrameRoot");)s++;if(C===Y.length||s===Z.length)for(C=Y.length-1,s=Z.length-1;1<=C&&0<=s&&Y[C]!==Z[s];)s--;for(;1<=C&&0<=s;C--,s--)if(Y[C]!==Z[s]){if(C!==1||s!==1)do if(C--,s--,0>s||Y[C]!==Z[s]){var $=`
`+Y[C].replace(" at new "," at ");return e.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",e.displayName)),typeof e=="function"&&ue.set(e,$),$}while(1<=C&&0<=s);break}}}finally{se=!1,B.H=i,d(),Error.prepareStackTrace=o}return Y=(Y=e?e.displayName||e.name:"")?m(Y):"",typeof e=="function"&&ue.set(e,Y),Y}function S(e){if(e==null)return"";if(typeof e=="function"){var n=e.prototype;return E(e,!(!n||!n.isReactComponent))}if(typeof e=="string")return m(e);switch(e){case r:return m("Suspense");case t:return m("SuspenseList")}if(typeof e=="object")switch(e.$$typeof){case v:return e=E(e.render,!1),e;case c:return S(e.type);case D:n=e._payload,e=e._init;try{return S(e(n))}catch{}}return""}function P(){var e=B.A;return e===null?null:e.getOwner()}function W(e){if(fe.call(e,"key")){var n=Object.getOwnPropertyDescriptor(e,"key").get;if(n&&n.isReactWarning)return!1}return e.key!==void 0}function x(e,n){function o(){ye||(ye=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",n))}o.isReactWarning=!0,Object.defineProperty(e,"key",{get:o,configurable:!0})}function M(){var e=y(this.type);return xe[e]||(xe[e]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),e=this.props.ref,e!==void 0?e:null}function A(e,n,o,i,N,C){return o=C.ref,e={$$typeof:a,type:e,key:n,props:C,_owner:N},(o!==void 0?o:null)!==null?Object.defineProperty(e,"ref",{enumerable:!1,get:M}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}function p(e,n,o,i,N,C){if(typeof e=="string"||typeof e=="function"||e===f||e===T||e===u||e===r||e===t||e===te||typeof e=="object"&&e!==null&&(e.$$typeof===D||e.$$typeof===c||e.$$typeof===b||e.$$typeof===w||e.$$typeof===v||e.$$typeof===Ye||e.getModuleId!==void 0)){var s=n.children;if(s!==void 0)if(i)if(re(s)){for(i=0;i<s.length;i++)X(s[i],e);Object.freeze&&Object.freeze(s)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else X(s,e)}else s="",(e===void 0||typeof e=="object"&&e!==null&&Object.keys(e).length===0)&&(s+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),e===null?i="null":re(e)?i="array":e!==void 0&&e.$$typeof===a?(i="<"+(y(e.type)||"Unknown")+" />",s=" Did you accidentally export a JSX literal instead of a component?"):i=typeof e,console.error("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",i,s);if(fe.call(n,"key")){s=y(e);var I=Object.keys(n).filter(function(Y){return Y!=="key"});i=0<I.length?"{key: someKey, "+I.join(": ..., ")+": ...}":"{key: someKey}",Re[s+i]||(I=0<I.length?"{"+I.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,i,s,I,s),Re[s+i]=!0)}if(s=null,o!==void 0&&(_(o),s=""+o),W(n)&&(_(n.key),s=""+n.key),"key"in n){o={};for(var F in n)F!=="key"&&(o[F]=n[F])}else o=n;return s&&x(o,typeof e=="function"?e.displayName||e.name||"Unknown":e),A(e,s,C,N,P(),o)}function X(e,n){if(typeof e=="object"&&e&&e.$$typeof!==Pe){if(re(e))for(var o=0;o<e.length;o++){var i=e[o];z(i)&&O(i,n)}else if(z(e))e._store&&(e._store.validated=1);else if(e===null||typeof e!="object"?o=null:(o=k&&e[k]||e["@@iterator"],o=typeof o=="function"?o:null),typeof o=="function"&&o!==e.entries&&(o=o.call(e),o!==e))for(;!(e=o.next()).done;)z(e.value)&&O(e.value,n)}}function z(e){return typeof e=="object"&&e!==null&&e.$$typeof===a}function O(e,n){if(e._store&&!e._store.validated&&e.key==null&&(e._store.validated=1,n=L(n),!pe[n])){pe[n]=!0;var o="";e&&e._owner!=null&&e._owner!==P()&&(o=null,typeof e._owner.tag=="number"?o=y(e._owner.type):typeof e._owner.name=="string"&&(o=e._owner.name),o=" It was passed a child from "+o+".");var i=B.getCurrentStack;B.getCurrentStack=function(){var N=S(e.type);return i&&(N+=i()||""),N},console.error('Each child in a list should have a unique "key" prop.%s%s See https://react.dev/link/warning-keys for more information.',n,o),B.getCurrentStack=i}}function L(e){var n="",o=P();return o&&(o=y(o.type))&&(n=`

Check the render method of \``+o+"`."),n||(e=y(e))&&(n=`

Check the top-level render call using <`+e+">."),n}var U=h,a=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),b=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),r=Symbol.for("react.suspense"),t=Symbol.for("react.suspense_list"),c=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),k=Symbol.iterator,oe=Symbol.for("react.client.reference"),B=U.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe=Object.prototype.hasOwnProperty,G=Object.assign,Ye=Symbol.for("react.client.reference"),re=Array.isArray,q=0,de,he,ve,ge,me,Ee,we;j.__reactDisabledLog=!0;var ae,be,se=!1,ue=new(typeof WeakMap=="function"?WeakMap:Map),Pe=Symbol.for("react.client.reference"),ye,xe={},Re={},pe={};K.Fragment=f,K.jsx=function(e,n,o,i,N){return p(e,n,o,!1,i,N)},K.jsxs=function(e,n,o,i,N){return p(e,n,o,!0,i,N)}}()),K}var ie;function Me(){return ie||(ie=1,process.env.NODE_ENV==="production"?ee.exports=Te():ee.exports=Ce()),ee.exports}var _e=Me();function Se(y,g,_,j,R,d){const[m,E]=h.useState(null),[S,P]=h.useState(null),[W,x]=h.useState(null),M=h.useRef({x:0,y:0}),A=h.useRef({x:0,y:0}),p=h.useRef({width:0,height:0}),X=(a,l)=>{for(let f=g.length-1;f>=0;f--){const u=g[f];if(a>=u.x&&a<=u.x+u.width&&l>=u.y&&l<=u.y+u.height)return u}},z=(a,l,f,u=10)=>{const T={tl:{x:a.x,y:a.y},tr:{x:a.x+a.width,y:a.y},bl:{x:a.x,y:a.y+a.height},br:{x:a.x+a.width,y:a.y+a.height}};for(const w in T){if(!w)continue;const b=T[w].x,v=T[w].y;if(Math.abs(l-b)<=u&&Math.abs(f-v)<=u)return w}return null},O=(a,l)=>{if(d){const u=g.find(T=>T.id===_);if(u){const T=z(u,a,l);if(T){P(u.id),x(T),A.current={x:a,y:l},p.current={width:u.width,height:u.height},R?.(!0);return}}}const f=X(a,l);f?(E(f.id),M.current={x:a-f.x,y:l-f.y},R?.(!0),d?.(f.id)):d?.(void 0)},L=(a,l)=>{if(S&&W){const u=a-A.current.x,T=l-A.current.y,w=g.map(b=>{if(b.id!==S)return b;let v=p.current.width,r=p.current.height;switch(W){case"tl":{const t=p.current.width-u,c=p.current.height-T;v=Math.max(t,10),r=Math.max(c,10);break}case"tr":{const t=p.current.width+u,c=p.current.height-T;v=Math.max(t,10),r=Math.max(c,10);break}case"bl":{const t=p.current.width-u,c=p.current.height+T;v=Math.max(t,10),r=Math.max(c,10);break}case"br":{const t=p.current.width+u,c=p.current.height+T;v=Math.max(t,10),r=Math.max(c,10);break}}return v=Math.max(10,v),r=Math.max(10,r),{...b,width:v,height:r}});j?.(w);return}if(!m)return;const f=g.map(u=>u.id===m?{...u,x:a-M.current.x,y:l-M.current.y}:u);j?.(f)},U=()=>{E(null),P(null),x(null),R?.(!1)};h.useEffect(()=>{const a=y.current;if(!a)return;const l=f=>{const u=a.getBoundingClientRect(),T=f.clientX-u.left,w=f.clientY-u.top;if(d){const b=g.find(v=>v.id===_);if(b){const v=z(b,T,w);if(v){const r={tl:"nwse-resize",br:"nwse-resize",tr:"nesw-resize",bl:"nesw-resize"};a.style.cursor=r[v];return}}}a.style.cursor=m||S?"grabbing":"default"};return a.addEventListener("mousemove",l),()=>{a.removeEventListener("mousemove",l),a.style.cursor="default"}},[y,g,d,m,S]),h.useEffect(()=>{const a=y.current;if(!a)return;const l=w=>{const b=a.getBoundingClientRect();O(w.clientX-b.left,w.clientY-b.top)},f=w=>{if(!m&&!S)return;const b=a.getBoundingClientRect();L(w.clientX-b.left,w.clientY-b.top)},u=w=>{if(w.touches.length!==1)return;const b=a.getBoundingClientRect(),v=w.touches[0];O(v.clientX-b.left,v.clientY-b.top)},T=w=>{if(w.touches.length!==1||!m&&!S)return;const b=a.getBoundingClientRect(),v=w.touches[0];L(v.clientX-b.left,v.clientY-b.top)};return a.addEventListener("mousedown",l),window.addEventListener("mousemove",f),window.addEventListener("mouseup",U),a.addEventListener("touchstart",u,{passive:!1}),window.addEventListener("touchmove",T,{passive:!1}),window.addEventListener("touchend",U),()=>{a.removeEventListener("mousedown",l),window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",U),a.removeEventListener("touchstart",u),window.removeEventListener("touchmove",T),window.removeEventListener("touchend",U)}},[y,m,S,W,g,j,R,d])}function je({image:y,cropWidth:g,cropHeight:_,rotation:j,initialZoom:R,stickers:d,setOutputImage:m,onStickersChange:E}){const S=h.useRef(null),[P,W]=h.useState({x:0,y:0}),[x,M]=h.useState(R),[A,p]=h.useState(!1),[X,z]=h.useState(void 0),O=h.useRef(null),L=(r,t,c)=>Math.min(Math.max(r,t),c),U=r=>{if(!O.current||A)return;const t=x/100,c=O.current.width*t,D=O.current.height*t,te=Math.max(0,(c-g)/2),k=Math.max(0,(D-_)/2),oe=L(r.x,-te,te),B=L(r.y,-k,k);W({x:oe,y:B})};h.useEffect(()=>{const r=new Image;r.onload=()=>{O.current=r,v()},r.src=y},[y,x,P,j,d,X]);const a=(r,t,c)=>{r.save(),r.fillStyle="#007bff",r.strokeStyle="#fff",r.lineWidth=2,r.beginPath(),r.rect(t-10/2,c-10/2,10,10),r.fill(),r.stroke(),r.restore()},l=h.useRef({}),f=()=>{const r=S.current,t=r?.getContext("2d");if(!r||!t||!O.current)return;r.width=g,r.height=_,t.clearRect(0,0,g,_),t.save();const c=x/100;return t.translate(P.x+g/2,P.y+_/2),t.rotate(j*Math.PI/180),t.scale(c,c),t.drawImage(O.current,-O.current.width/2,-O.current.height/2),t.restore(),t},u=(r,t)=>{let c=l.current[t.src];if(!c){c=new Image,c.src=t.src,l.current[t.src]=c,c.onload=()=>v();return}c.complete&&r.drawImage(c,t.x,t.y,t.width,t.height)},T=(r,t)=>{r.font=`${t.height}px sans-serif`,r.textAlign="left",r.textBaseline="top",r.fillText(t.src,t.x,t.y)},w=(r,t)=>{r.strokeStyle="#007bff",r.lineWidth=2,r.strokeRect(t.x,t.y,t.width,t.height),a(r,t.x,t.y),a(r,t.x+t.width,t.y),a(r,t.x,t.y+t.height),a(r,t.x+t.width,t.y+t.height)},b=r=>{const t=r.toDataURL();m?.(t,d)},v=()=>{const r=S.current,t=f();!t||!r||(d.forEach(c=>{c.src.startsWith("data:image")||c.src.startsWith("http")?u(t,c):T(t,c),c.id===X&&w(t,c)}),m&&b(r))};return Se(S,d,X,E,p,z),{canvasRef:S,clamp:L,setCurrentZoom:M,currentZoom:x,setPosition:U,position:P}}function Ae(y,g){const _=h.useRef(!1),j=h.useRef({x:0,y:0});return{onMouseDown:E=>{_.current=!0,j.current={x:E.clientX-g.x,y:E.clientY-g.y}},onMouseMove:E=>{_.current&&y(E.clientX-j.current.x,E.clientY-j.current.y)},onMouseUp:()=>{_.current=!1}}}function Oe(y,g,_,j,R){const d=h.useRef(!1),m=h.useRef({x:0,y:0}),E=h.useRef(null);return{onTouchStart:x=>{if(x.touches.length===1){const M=x.touches[0];d.current=!0,m.current={x:M.clientX-g.x,y:M.clientY-g.y}}else if(x.touches.length===2){const[M,A]=Array.from(x.touches),p=Math.hypot(A.clientX-M.clientX,A.clientY-M.clientY);E.current=p}},onTouchMove:x=>{if(x.preventDefault(),x.touches.length===1&&d.current){const M=x.touches[0];y(M.clientX-m.current.x,M.clientY-m.current.y)}else if(x.touches.length===2){const[M,A]=Array.from(x.touches),p=Math.hypot(A.clientX-M.clientX,A.clientY-M.clientY);if(E.current!=null){const z=(p-E.current)*.3;_(R(j+z,10,500))}E.current=p}},onTouchEnd:()=>{d.current=!1,E.current=null}}}function Ne({image:y,cropWidth:g,cropHeight:_,zoom:j,rotation:R,setOutputImage:d,stickers:m,onStickersChange:E}){const{canvasRef:S,clamp:P,setCurrentZoom:W,currentZoom:x,setPosition:M,position:A}=je({image:y,cropWidth:g,cropHeight:_,rotation:R,initialZoom:j,setOutputImage:d,stickers:m,onStickersChange:E}),{onMouseDown:p,onMouseMove:X,onMouseUp:z}=Ae((l,f)=>M({x:l,y:f}),A),{onTouchStart:O,onTouchMove:L,onTouchEnd:U}=Oe((l,f)=>M({x:l,y:f}),A,W,x,P),a=l=>{l.preventDefault();const u=-l.deltaY*.1;W(x+u)};return h.useEffect(()=>{const l=S.current;if(l)return l.addEventListener("wheel",a,{passive:!1}),()=>{l.removeEventListener("wheel",a)}},[S,x]),_e.jsx("canvas",{ref:S,style:{touchAction:"none",cursor:"grab"},onMouseDown:p,onMouseMove:X,onMouseUp:z,onMouseLeave:z,onTouchStart:O,onTouchMove:L,onTouchEnd:U})}V.ImageCanvas=Ne,Object.defineProperty(V,Symbol.toStringTag,{value:"Module"})});
